# COMBINE_LLM 项目文档导航

## 📚 文档概览

欢迎来到COMBINE_LLM项目的文档中心。本目录包含了系统的完整技术文档。

---

## 🗂️ 文档目录

### 核心设计文档

| 序号 | 文档名称 | 文档类型 | 适用读者 | 说明 |
|-----|---------|----------|---------|------|
| **01** | [架构设计文档](./01-架构设计文档.md) | 战略性 | 架构师、技术负责人、全体开发 | 系统如何组织、模块划分、技术选型 |
| **02** | [详细设计文档](./02-详细设计文档.md) | 战术性 | 开发工程师 | 类定义、方法实现、算法流程 |
| **03** | [数据库设计文档](./03-数据库设计文档.md) | 技术性 | 后端开发、DBA | ES、Neo4j、MySQL、Redis设计 |

### 实施文档

| 序号 | 文档名称 | 文档类型 | 适用读者 | 说明 |
|-----|---------|----------|---------|------|
| **04** | [实现路线](./实现路线.md) | 执行性 | 项目经理、开发团队 | 5阶段实施路线图 |
| **05** | [第一阶段完成总结](./第一阶段完成总结.md) | 总结性 | 全体成员 | 基础设施层完成情况 |
| **06** | [第二三四阶段完成总结](./第二三四阶段完成总结.md) | 总结性 | 全体成员 | Domain/Application/API层完成情况 |
| **07** | [快速开始指南](./快速开始指南.md) | 操作性 | 新用户、运维人员 | 安装、配置、使用指南 |

---

## 🎯 各文档详细说明

### 01-架构设计文档.md

**回答的问题**：系统该如何组织？

**核心内容**：
- ✅ 系统分层架构（API层、应用服务层、领域逻辑层、基础设施层）
- ✅ 核心模块划分（意图解析、知识检索、提示词构建等）
- ✅ 技术选型及理由（FastAPI、Pydantic、loguru等）
- ✅ 数据流设计（三种查询模式：ES/Neo4j/混合）
- ✅ 部署架构（服务拓扑、扩展性设计）
- ✅ 实施路线图（5个阶段的重构计划）

---

### 02-详细设计文档.md

**回答的问题**：每个模块如何实现？

**核心内容**：
- ✅ 领域模型设计（Intent、Knowledge、Message、Session）
- ✅ API层详细设计（请求/响应Schema、路由定义）
- ✅ 应用服务层详细设计（ChatService、SessionService）
- ✅ 领域逻辑层详细设计（IntentParser、Retriever、PromptBuilder）
- ✅ 基础设施层详细设计（LLMClient、Repository模式）
- ✅ 配置管理详细设计（Pydantic Settings）
- ✅ 日志与监控详细设计（loguru配置、Prometheus指标）
- ✅ 关键时序图（ES查询流程时序）

---

### 03-数据库设计文档.md

**回答的问题**：数据如何存储和流转？

**核心内容**：
- ✅ 数据库总览（4个数据库的角色分工）
- ✅ Elasticsearch设计（3个索引：kb_vector_store、conversation_history、user_memory）
- ✅ Neo4j设计（图模型、节点类型、关系类型、Cypher查询）
- ✅ MySQL设计（users表、sessions表）
- ✅ Redis设计（会话元数据Hash、会话消息List）
- ✅ 数据流转与同步（创建会话、流式对话、数据一致性）
- ✅ 性能优化建议（ES、Neo4j、MySQL、Redis优化）


**关键设计**：
- **双层存储架构**：Redis缓存 + ES持久化
- **三库同步**：MySQL（事实来源） → Redis（快速访问） → ES（检索分析）
- **数据一致性**：强一致性 vs 最终一致性的权衡

---

## 🔍 快速查找

### 按功能模块查找

| 功能模块 | 相关文档章节 |
|---------|------------|
| **意图解析** | 架构设计-4.3 / 详细设计-4.1 |
| **知识检索** | 架构设计-4.3 / 详细设计-4.2 / 数据库设计-2.2.1 |
| **会话管理** | 架构设计-4.2 / 详细设计-3.1 / 数据库设计-4.2.2 |
| **流式响应** | 架构设计-6.1 / 详细设计-3.1 |
| **配置管理** | 架构设计-7 / 详细设计-6 |
| **日志监控** | 架构设计-8 / 详细设计-7 |

### 按技术栈查找

| 技术 | 相关文档章节 |
|-----|------------|
| **FastAPI** | 架构设计-5.1 / 详细设计-2 |
| **Pydantic** | 架构设计-5.1 / 详细设计-6.1 |
| **Elasticsearch** | 架构设计-5.2 / 数据库设计-2 |
| **Neo4j** | 架构设计-5.2 / 数据库设计-3 |
| **MySQL** | 架构设计-5.2 / 数据库设计-4 |
| **Redis** | 架构设计-5.2 / 数据库设计-5 |
| **LangChain/Langfuse** | 详细设计-5.1 |

---

## 📝 文档约定

### 文档格式约定

- **标题层级**：最多使用4级标题（# ## ### ####）
- **代码块**：使用```语法，指定语言类型（python/sql/bash/json等）
- **表格**：使用Markdown表格，表头加粗
- **链接**：文档内链接使用相对路径

### 术语约定

| 术语 | 说明 |
|-----|------|
| **模块** | 代码组织的逻辑单元（如意图解析模块） |
| **层** | 架构分层（API层、应用服务层等） |
| **服务** | 提供特定功能的类（如ChatService） |
| **客户端** | 与外部系统交互的封装（如LLMClient） |
| **仓储** | 数据访问层（如MessageRepository） |
| **意图** | 用户查询的解析结果（Intent对象） |
| **检索** | 从知识库获取相关知识的过程 |

---

## 🔧 文档维护

### 文档更新规则

1. **重大架构变更**：必须更新架构设计文档
2. **新增API接口**：必须更新API接口文档
3. **数据库schema变更**：必须更新数据库设计文档
4. **类/方法变更**：建议更新详细设计文档

### 版本控制

所有文档均使用Git版本控制，重要变更需在文档末尾的"文档变更记录"中说明。

---
